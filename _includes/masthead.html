{% include base_path %}

<div class="masthead">
  <div class="masthead__inner-wrap">    
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="{{ base_path }}/">{{ site.title }}</a></li>
          {% for link in site.data.navigation.main %}
          <!-- Don't show the ones exclude -->
          <!-- https://stackoverflow.com/questions/25452429/excluding-page-from-jekyll-navigation-bar -->
            {% unless link.exclude %} 
              {% if link.url contains 'http' %}
                {% assign domain = '' %}
              {% else %}
                {% assign domain = base_path %}
              {% endif %}
              <li class="masthead__menu-item"><a href="{{ domain }}{{ link.url }}">{{ link.title }}</a></li>
            {% endunless %}
          {% endfor %}                                
        </ul> 
        <ul class="hidden-links hidden"></ul>
      </nav>
      {% if site.minimal_mistakes_skin2 %}
        <span class="togglefa" onclick="toggleTheme()">
          <i class="fas fa-sun theme-icon-light" aria-hidden="true"></i>
          <i class="fa fa-toggle-on" aria-hidden="true"></i>
          <i class="fas fa-moon theme-icon-dark" aria-hidden="true"></i>
        </span>
        <script>
          function toggleTheme() {
            node1=document.getElementById('theme_source');
            node2=document.getElementById('theme_source_2');
            if(node1.getAttribute('rel')=='stylesheet'){
              node1.setAttribute('rel', 'stylesheet alternate'); 
              node2.setAttribute('rel', 'stylesheet');
              sessionStorage.setItem('theme', 'dark');
              document.querySelector('.theme-icon-light').style.opacity = '0.3';
              document.querySelector('.theme-icon-dark').style.opacity = '1';
            }else{
              node2.setAttribute('rel', 'stylesheet alternate'); 
              node1.setAttribute('rel', 'stylesheet');
              sessionStorage.setItem('theme', 'light');
              document.querySelector('.theme-icon-light').style.opacity = '1';
              document.querySelector('.theme-icon-dark').style.opacity = '0.3';
            } 
            return false;
          }
          
          // Set initial icon state based on current theme
          window.addEventListener('DOMContentLoaded', function() {
            let theme = sessionStorage.getItem('theme');
            if(theme === 'dark') {
              document.querySelector('.theme-icon-light').style.opacity = '0.3';
              document.querySelector('.theme-icon-dark').style.opacity = '1';
            } else {
              document.querySelector('.theme-icon-light').style.opacity = '1';
              document.querySelector('.theme-icon-dark').style.opacity = '0.3';
            }
          });
        </script>
      {% endif %}
    </div>
  </div>
</div>

<style>
  .masthead__inner-wrap {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: #212121; /* Ensures the background color is consistent */
    padding: 0 10px; /* Adds some padding for better spacing */
    width: 100%;
  }
  .greedy-nav {
    display: flex;
    align-items: center;
    flex-grow: 1;
    background-color: #212121; /* Match the background color */
  }
  .visible-links {
    display: flex;
    align-items: center;
    margin: 0;
    padding: 0;
    list-style: none;
  }
  .visible-links li {
    margin-right: 20px;
  }
  .masthead__menu-item a {
    color: white;
    text-decoration: none;
  }
  .masthead__menu-item--lg a {
    font-size: 1.25em;
  }
  .togglefa {
    color: white;
    display: inline-flex;
    align-items: center;
    gap: 8px;
    margin-left: auto;
    cursor: pointer;
    font-size: 1.2em;
  }
  .togglefa .theme-icon-light,
  .togglefa .theme-icon-dark {
    transition: opacity 0.3s ease;
  }
  .togglefa .fa-toggle-on {
    font-size: 1.1em;
  }
  .masthead__menu {
    display: flex;
    align-items: center;
    width: 100%;
    background-color: #212121; /* Match the background color */
  }
</style>
